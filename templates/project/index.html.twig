{% extends 'base.html.twig' %}

{% block title %}Project index{% endblock %}

{% block body %}
    {# === Titre de la page === #}
    <div class="projects-title">Gestion des projets</div>

    {# === Grille des projets === #}
    <div class="projects-grid">
        {% for project in projects %}
            <div class="project-card">
                {# --- Titre du projet --- #}
                <div class="project-title">{{ project.name }}</div>
                {# --- Image du projet --- #}
                <div class="project-media">
                    {% if project.image %}
                        <img src="/{{ project.image }}" alt="Image projet {{ project.name }}">
                    {% else %}
                        <div class="project-placeholder">Aucune image</div>
                    {% endif %}
                </div>
                {# --- Langages du projet --- #}
                <div class="project-langs">
                    {% if project.langages is iterable %}
                        {% for lang in project.langages %}
                            <span class="lang-chip">{{ lang }}</span>
                        {% endfor %}
                    {% elseif project.langages %}
                        <span class="lang-chip">{{ project.langages }}</span>
                    {% endif %}
                </div>
                {# --- Description du projet --- #}
                <div class="project-desc">{{ project.description|e|nl2br }}</div>
                {# --- Actions (éditer, supprimer) --- #}
                <div class="project-actions" style="flex-direction:column;align-items:center;gap:0;">
                    <div style="display:flex;gap:18px;">
                        <a href="{{ path('app_project_edit', {'id': project.id}) }}" class="cv-button">Éditer</a>
                    </div>
                    <form method="post" action="{{ path('app_project_delete', {'id': project.id}) }}" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer ce projet ?');" style="margin-top:10px;width:100%;display:flex;justify-content:center;">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ project.id) }}">
                        <button class="cv-button project-delete-btn" style="background:#e74c3c;color:#fff;border-color:#e74c3c;width:80%;margin:0 auto;">Supprimer</button>
                    </form>
                </div>
            </div>
        {% else %}
                <div style="grid-column:1/-1;text-align:center;color:#888;font-size:1.2rem;padding:40px 0;">Aucun projet trouvé</div>
            {% endfor %}
        </div>

{% endblock %}
