<section id="about" class="about">
  <div class="about-card">
    <h2 class="about-title">À propos</h2>
    <div class="about-grid">
      <div class="about-left">
         <div
          class="about-textarea"
          style="white-space: pre-wrap"
          {% if is_granted('ROLE_ADMIN') %}
            contenteditable="true"
            data-admin-edit="about-text"
          {% endif %}
        >{{ aboutText is not empty ? aboutText : 'Zone de texte' }}</div>

        <div class="skills-row">
          <div class="skill-box hard-box">
            <h3 class="pane-title">Hard skill</h3>
            <div class="pane-body">
              <ul class="skills-list hard">
                {% for hs in hardSkills %}
                  <li
                    class="skill-item"
                    data-skill-type="hard"
                    data-skill-id="{{ hs.id }}"
                    {% if is_granted('ROLE_ADMIN') %}contenteditable="true"{% endif %}
                  >{{ hs.language ?? hs.name ?? hs.label ?? '' }}</li>
                {% else %}
                  <li>Aucun hard skill</li>
                {% endfor %}
              </ul>
            </div>
          </div>
          <div class="skill-box soft-box">
            <h3 class="pane-title">Soft skill</h3>
            <div class="pane-body">
              <ul class="skills-list soft">
                {% for ss in softSkills %}
                  <li
                    class="skill-item"
                    data-skill-type="soft"
                    data-skill-id="{{ ss.id }}"
                    {% if is_granted('ROLE_ADMIN') %}contenteditable="true"{% endif %}
                  >{{ ss.skill ?? ss.name ?? ss.label ?? '' }}</li>
                {% else %}
                  <li>Aucun soft skill</li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
        {% if is_granted('ROLE_ADMIN') %}
        <div class="skills-form-row">
          <form method="post" action="{{ path('app_home') }}" class="skill-form hard-form">
            <input name="new_hard_skill" type="text" placeholder="Nouveau hard skill" required>
            <button type="submit">Ajouter un hardskill</button>
          </form>
          <form method="post" action="{{ path('app_home') }}" class="skill-form soft-form">
            <input name="new_soft_skill" type="text" placeholder="Nouveau soft skill" required>
            <button type="submit">Ajouter un soft skill</button>
          </form>
        </div>
        {% endif %}

        {% if is_granted('ROLE_ADMIN') %}
        <div class="form-actions" style="margin-top:2rem">
          <button
            id="save-skills"
            class="cv-button"
            data-save-url="{{ path('skills_save') }}"
          >Confirmer les modifications</button>
        </div>
        {% endif %}
      </div>

      <div class="about-right">
        <img src="{{ asset('cv/images/profile.jpg') }}?v={{ random() }}" alt="Photo de profil" class="about-photo" id="profilePhoto">
        {% if is_granted('ROLE_ADMIN') %}
        <form id="photo-upload-form" method="post" action="{{ path('admin_photo_upload') }}" enctype="multipart/form-data" style="margin-top:10px;">
          <input type="file" id="photo-file-input" name="photo_file" accept="image/jpeg" hidden>
          <button type="button" id="photo-upload-btn" class="cv-button">Changer la photo</button>
        </form>
        {% endif %}
        <a class="cv-button" href="{{ asset('cv/CV.pdf') }}" download style="margin-top:18px;">Télécharger le CV</a>
        {% if is_granted('ROLE_ADMIN') %}
        <form id="cv-upload-form" method="post" action="{{ path('admin_cv_upload') }}" enctype="multipart/form-data" style="margin-top:10px;">
          <input type="file" id="cv-file-input" name="cv_file" accept="application/pdf" hidden>
          <button type="button" id="cv-upload-btn" class="cv-button">Changer le CV</button>
        </form>
        {% endif %}
      </div>
    </div>
  </div>
</section>